let submitedData={},textTranslations,map,orignAutocomplete,destinationAutocomplete,currentDevice;function initMap(){map=new google.maps.Map(document.getElementById("map"),{mapId:"DEMO_MAP_ID",zoom:11,center:{lat:47.34002,lng:8.58162},disableDefaultUI:!0,draggable:!1,clickable:!1});let e=new google.maps.StyledMapType([{elementType:"geometry",stylers:[{color:"#000000"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#2270DE"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#cae1ff"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#1e90ff"}]},],{name:"Custom Map"});map.mapTypes.set("custom_map",e),map.setMapTypeId("custom_map"),initAutocomplete()}function initAutocomplete(){let e=document.getElementsByName("origin")[0],t=document.getElementsByName("destination")[0],l={componentRestrictions:{country:["de","at","ch"]},strictBounds:!1};orignAutocomplete=new google.maps.places.Autocomplete(e,l),destinationAutocomplete=new google.maps.places.Autocomplete(t,l),orignAutocomplete.addListener("place_changed",()=>{let t=orignAutocomplete.getPlace(),l=t.types.includes("airport");e.setAttribute("airport",l)}),destinationAutocomplete.addListener("place_changed",()=>{let e=destinationAutocomplete.getPlace(),l=e.types.includes("airport");t.setAttribute("airport",l)})}function switchTab(e){let t="invisible";"route"==e?document.getElementById("trip").classList.toggle(t):"trip"==e?("Mobile"==currentDevice?(document.getElementById("map").style.display="flex",document.getElementsByClassName("route-form-container")[0].style.height="750px"):"Tablet"==currentDevice&&(document.getElementById("map").style.display="flex",document.getElementsByClassName("route-form-container")[0].style.height="700px"),document.getElementById("route").classList.toggle(t)):(document.getElementById("trip").classList.add(t),document.getElementById("route").classList.add(t)),document.getElementById(e).classList.toggle(t)}function initForm(){var e=document.getElementById("route-form");e.addEventListener("submit",function(t){if(t.preventDefault(),validateRouteForm()){let l="false";("true"==e.elements.origin.getAttribute("airport")||"true"==e.elements.destination.getAttribute("airport"))&&(l="true");let n={dataSource:"route",type:e.elements.type.value,origin:e.elements.origin.value,destination:e.elements.destination.value,airport:l,flightNumber:e.elements.flightNumber.value,returnDrive:e.elements["return-drive"].value,hours:e.elements["hours-select"].value,car:e.elements.cars.value};submitedData.route=n;let a=JSON.stringify(n);window.parent.postMessage(a,"*"),document.getElementById("loading").style.display="block"}}),document.getElementById("type-row").addEventListener("click",typeHandler);var t=document.getElementById("trip-form");t.addEventListener("submit",function(e){if(e.preventDefault(),validateTripForm()){let l={dataSource:"trip",name:t.elements.name.value,email:t.elements.email.value,phone:t.elements.phone.value,baggageCount:t.elements.baggageCount.value,personCount:t.elements.personCount.value,childCount:t.elements.childCount.value,date:t.elements.date.value,pickupTime:t.elements.pickupTime.value,comment:t.elements.comment.value};submitedData.trip=l,submitedData.dataSource="trip";let n=JSON.stringify(submitedData);window.parent.postMessage(n,"*"),document.getElementById("loading").style.display="block"}}),document.getElementById("reload").addEventListener("click",function(e){location.reload();let t=JSON.stringify({dataSource:"config"});return window.parent.postMessage(t,"*"),!1}),window.addEventListener("message",async t=>{let{dataSource:l}=JSON.parse(t.data);if("config"==l){let{dataSource:n,language:a,device:r,translations:s,cars:i,maxHours:o,kilometerPerHour:m}=JSON.parse(t.data);currentDevice=r,handleTranslation(a,s);let d=document.getElementById("cars");1==d.childElementCount&&(i.forEach(e=>{let t=document.createElement("option");t.value=e.NAME,t.textContent=e.NAME,t.setAttribute("maxPerson",e.MAX_PERSON),t.setAttribute("maxBaggage",e.MAX_BAGGAGE),d.appendChild(t)}),d.addEventListener("change",carsSelectChange)),createHoursSelect(o,m)}else if("route"==l){let{distance:y,duration:T,startLocation:p,endLocation:E,polylines:u,bounds:g,price:c}=JSON.parse(t.data);if(submitedData.distance=y,submitedData.duration=T,submitedData.price=c,submitedData.polylines=u,submitedData.bounds=g,document.getElementById("distance").innerHTML=textTranslations.TABS.TRIP.DISTANCE+": <br>"+y+" Km",document.getElementById("duration").innerHTML=textTranslations.TABS.TRIP.DURATION+": <br>"+T,document.getElementById("price").innerHTML=textTranslations.TABS.TRIP.PRICE+": <br>"+c+" CHF",""!=u){let B=google.maps.geometry.encoding.decodePath(u);new google.maps.Marker({position:p,map:map,title:e.elements.origin.value});let{PinView:I,AdvancedMarkerView:f}=await google.maps.importLibrary("marker"),A=new I({background:"#ffffff"});new f({map:map,position:E,content:A.element,title:e.elements.destination.value});let R=new google.maps.Polyline({path:B,strokeColor:"#FF0004",strokeWeight:3,strokeOpacity:.7});R.setMap(map);var S=new google.maps.LatLngBounds;S.extend(p),S.extend(E),map.fitBounds(S)}document.getElementById("loading").style.display="none",switchTab("trip")}else{let{dataSource:N,status:b,price:h,route:L,trip:v}=JSON.parse(t.data);b?(document.getElementById("booking-class").innerHTML=textTranslations.TABS.REQUEST.BOOKING_CLASS+": "+L.car,document.getElementById("dateTime").innerHTML=textTranslations.TABS.TRIP.DATE+": "+v.date+" / "+textTranslations.TABS.TRIP.TIME+": "+v.pickupTime,document.getElementById("originDestination").innerHTML=textTranslations.TABS.ROUTE.ORIGIN+": "+L.origin+" / "+textTranslations.TABS.ROUTE.DESTINATION+": "+L.destination,document.getElementById("totalPrice").innerHTML=textTranslations.TABS.TRIP.PRICE+": "+h+" CHF",document.getElementById("counts").innerHTML=textTranslations.TABS.TRIP.PERSONS+": "+v.personCount+" / "+textTranslations.TABS.TRIP.CHILDREN+": "+v.childCount+" / "+textTranslations.TABS.TRIP.BAGGAGE+": "+v.baggageCount,document.getElementById("request-comment").innerHTML=textTranslations.TABS.TRIP.COMMENT+": "+v.comment):document.getElementById("request").innerHTML="<h2>"+textTranslations.ERRORS.UNKNOWN.SOMETHING_WENT_WRONG+"</h2><p>"+textTranslations.ERRORS.UNKNOWN.REQUEST_COULD_NOT_SUBMITED+"</p><p>"+textTranslations.ERRORS.UNKNOWN.PLEASE_CONTACT_US+"</p>",document.getElementById("loading").style.display="none",switchTab("request")}})}function carsSelectChange(){let e=document.getElementById("cars"),t=document.getElementById("baggageCount"),l=document.getElementById("personCount"),n=document.getElementById("childCount"),a=parseInt(e.options[e.selectedIndex].getAttribute("maxPerson")),r=parseInt(e.options[e.selectedIndex].getAttribute("maxBaggage"));if(t.childElementCount<=1)for(let s=0;s<=r;s++){let i=document.createElement("option");i.value=s,i.textContent=s,t.appendChild(i)}if(n.childElementCount<=1)for(let o=0;o<=a;o++){let m=document.createElement("option");m.value=o,m.textContent=textTranslations.TABS.TRIP.PERSONS+" "+o,l.appendChild(m);let d=document.createElement("option");d.value=o,d.textContent=textTranslations.TABS.TRIP.CHILDREN+" "+o,n.appendChild(d)}}function handleTranslation(e,t){textTranslations=t,document.getElementById("route-headline").innerHTML=t.TABS.ROUTE.HEADLINE,document.getElementById("transfer-ride").value=t.TABS.ROUTE.TYPE_ROW.TRANSFER_RIDE,document.getElementById("per-hour").value=t.TABS.ROUTE.TYPE_ROW.PER_HOUR,document.getElementsByName("origin")[0].placeholder=t.TABS.ROUTE.ORIGIN,document.getElementsByName("destination")[0].placeholder=t.TABS.ROUTE.DESTINATION,document.getElementsByName("flightNumber")[0].placeholder=t.TABS.ROUTE.FLIGHT_NUMBER,document.getElementById("return-drive-label").innerHTML=t.TABS.ROUTE.RETURN_DRIVE_SELECT.LABEL+":",document.getElementById("hours-select-label").innerHTML=t.TABS.ROUTE.HOURS_SELECT.LABEL+":",document.getElementById("cars-label").innerHTML=t.TABS.ROUTE.CARS.LABEL+":",document.getElementById("one-way").innerHTML=t.TABS.ROUTE.RETURN_DRIVE_SELECT.ONE_WAY,document.getElementById("round-trip").innerHTML=t.TABS.ROUTE.RETURN_DRIVE_SELECT.ROUND_TRIP,document.getElementById("please-select").innerHTML=t.TABS.ROUTE.CARS.PLEASE_SELECT,document.getElementById("route-submit").value=t.TABS.ROUTE.SUBMIT_BUTTON,document.getElementById("trip-headline").innerHTML=t.TABS.TRIP.HEADLINE,document.getElementsByName("name")[0].placeholder=t.TABS.TRIP.NAME,document.getElementsByName("email")[0].placeholder=t.TABS.TRIP.EMAIL,document.getElementsByName("phone")[0].placeholder=t.TABS.TRIP.PHONE,document.getElementById("baggage").innerHTML=t.TABS.TRIP.BAGGAGE,document.getElementsByName("date")[0].placeholder=t.TABS.TRIP.DATE,document.getElementsByName("pickupTime")[0].placeholder=t.TABS.TRIP.TIME,document.getElementById("maxPersonError").innerHTML=t.ERRORS.VEHICLE_CAPACITY,document.getElementById("dateTimeError").innerHTML=t.ERRORS.BOOKING_DATETIME,document.getElementsByName("comment")[0].placeholder=t.TABS.TRIP.COMMENT,document.getElementById("trip-submit").value=t.TABS.TRIP.SUBMIT_BUTTON,document.getElementById("request-headline").innerHTML=t.TABS.REQUEST.HEADLINE,document.getElementById("your-request").innerHTML=t.TABS.REQUEST.YOUR_BOOKING_REQUEST+":",document.getElementById("request-message").innerHTML=t.TABS.REQUEST.WE_WILL_CONTACT_YOU,document.getElementById("reload").value=t.TABS.REQUEST.SUBMIT_BUTTON,map.setOptions({language:e}),orignAutocomplete.setOptions({language:e}),destinationAutocomplete.setOptions({language:e})}function validateRouteForm(){return!0}function validateTripForm(){document.getElementById("dateTimeError").style.display="none",document.getElementById("maxPersonError").style.display="none";var e=document.getElementById("route-form"),t=document.getElementById("trip-form");let l=t.elements.date.value,n=t.elements.pickupTime.value,a=t.elements.personCount.value,r=t.elements.childCount.value,s=parseInt(a)+parseInt(r),i=e.elements.cars,o=parseInt(i.options[i.selectedIndex].getAttribute("maxPerson")),m=new Date(l+" "+n);m.setHours(m.getHours()-12);let d=m>new Date;!1==d&&(document.getElementById("dateTimeError").style.display="block");let y=parseInt(s)<=parseInt(o);return!1==y&&(document.getElementById("maxPersonError").style.display="block"),d&&y}function typeHandler(e){var t=e.target;if(!t.matches("input"))return;var l=document.getElementById("type-row").getElementsByTagName("input");for(let n of l)n.classList.remove("selected");t.classList.add("selected");let a=e.target.id;document.getElementById("route-form").elements.type.value=a,"transfer-ride"==a?(document.getElementsByName("destination")[0].style.display="flex",document.getElementsByName("destination")[0].setAttribute("required",""),document.getElementsByName("flightNumber")[0].style.display="flex",document.getElementById("return-drive").style.display="flex",document.getElementById("return-drive-label").style.display="flex",document.getElementById("hours-select").style.display="none",document.getElementById("hours-select-label").style.display="none",document.getElementById("distance").style.display="flex",document.getElementById("duration").style.display="flex"):(document.getElementsByName("destination")[0].style.display="none",document.getElementsByName("destination")[0].removeAttribute("required"),document.getElementsByName("flightNumber")[0].style.display="none",document.getElementById("return-drive").style.display="none",document.getElementById("return-drive-label").style.display="none",document.getElementById("hours-select").style.display="flex",document.getElementById("hours-select-label").style.display="flex",document.getElementById("distance").style.display="none",document.getElementById("duration").style.display="none")}function createHoursSelect(e,t){let l=document.getElementById("hours-select");if(!(l.childElementCount>1)){l.style.display="none";for(let n=1;n<=e;n++){let a=document.createElement("option");a.value=n,a.textContent=n+" ("+textTranslations.TABS.ROUTE.HOURS_SELECT.INCLUSIVE+n*t+"Km)",l.appendChild(a)}}}initForm();
